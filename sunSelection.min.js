"use strict"; !function (e, t) { function n() { function e(t, n, a) { var o = "", l = ""; return t.forEach(function (t, c) { var s = t[S.children], r = w.common._createLevel(a, c); s && s.length > 0 ? (o = w.elementLayout.createList(e(s, n + 1, r), { class: v.LineList, "data-parent": r, "v-show": "!showdrop && hoverSelectorStateList.indexOf('" + r + "') >= 0", ":style": " _computedDefaultWidthAndPosition(" + n + ") " }), i = i < n + 1 ? n + 1 : i) : o = "", t.linkMap = w.tools.computedLinkMap(r, t[S.text], t[S.id], n), I.patDwonDataMap[t[S.id]] = t, l += w.elementLayout.createListItem(t[S.text] + o, { class: v.LineItem + " " + (n > 0 && Boolean(o) && "sunSelection__state_hasChildren"), "@click.stop": "itemClick($event)", "@mouseover.stop": "itemOver", "data-id": t[S.id], "data-level": n, "data-index": c, "data-name": r, "data-isroot": 0 == n, "data-islast": "" == o, "data-module": "line", ":style": "_computedItemDefaultSize()", ":class": "{'sunSelection__state_hover':(hoverSelectorStateList.indexOf('" + r + "') >= 0),'sunSelection__state_selected': !showdrop && __computedSelectedItemList(" + c + ",'" + r + "'),'sunSelection__icon_selected': !showdrop && selectedIdList.indexOf('" + t[S.id] + "') >= 0}", ref: t[S.id] }) }), l } var t = "", n = "", i = 1; return t = w.elementLayout.createList(e(f, 0, 0), { class: v.LineList }), n = w.elementLayout.createWrap(t, { class: v.LineWrap, ref: "lineWrap" }), w.setData("zIndexLevel", i), n } function i() { function e(t, n, i) { var a = "", o = "", l = function (e, t) { return w.elementLayout.createPackingElement(e, t) }, c = ""; return t.forEach(function (t, s) { var r = t[S.children], u = w.common._createLevel(i, s); a = r && r.length > 0 ? w.elementLayout.createList(e(r, n + 1, u), { class: v.DropPanel_list, "data-parent": u, "v-show": "hoverSelectorStateList.indexOf('" + u + "') >= 0", ":style": " _computedDropPanelItemSize(" + n + "1) " }) : "", t.linkMap = w.tools.computedLinkMap(u, t[S.text], t[S.id], n), I.patDwonDataMap[t[S.id]] = t, c = l(t[S.text], { class: "drop__packing " + (Boolean(a) && "sunSelection__state_hasChildren"), "@click.stop": "itemClick($event)", "@mouseover.stop": "itemOver", "data-id": t[S.id], "data-level": n, "data-index": s, "data-name": u, "data-isroot": 0 == n, "data-islast": "" == a, "data-module": "drop", ":class": "{'sunSelection__icon_selected': selectedIdList.indexOf('" + t[S.id] + "') >= 0}" }), o += w.elementLayout.createListItem(c + a, { class: v.DropPanel_listItem, ":style": "_computedItemDefaultSize()", ":class": "{'sunSelection__state_hover': (hoverSelectorStateList.indexOf('" + u + "') >= 0),'sunSelection__state_selected': __computedSelectedItemList(" + s + ",'" + u + "')}", ref: t[S.id] }) }), o } var t = w.elementLayout.createList(e(h, 0, 0), { class: v.DropPanel_list, ":style": "_computedDropPanelItemSize(0)" }), n = w.elementLayout.createWrap(t, { class: v.DropPanel_list_wrap }), i = w.elementLayout.createElement("span", "{{item.text}}", { class: v.Selecor_controllItem, "v-for": "(item, index) in controlls", "@click": "controllSwicthCenter(item.type)", ":class": "_getBtnClass(item.type)" }), o = w.elementLayout.createWrap(i, { class: v.Selecor_controll }), l = w.elementLayout.createWrap("{{title}}" + o, { class: v.DropPanel_title }), c = a(); return w.elementLayout.createWrap(l + c + n, { class: v.DropPanel, "v-show": "showdrop", ref: "dropPanel" }) } function a() { var e = "", t = "", n = "", i = "", a = ""; return n = w.elementLayout.createElement("i", "", { class: v.Selecor_icon_cancel }), t = w.elementLayout.createElement("span", "{{item[alias.text]}}" + n, { class: v.Selecor_selectedItem, "v-for": "(item,index) in selectedDetailList", "v-show": "selectedDetailList.length > 0", "@click.stop": "cancelItem(item[alias.id])" }), i = w.elementLayout.createElement("span", "{{option.selector.title || '已选择'}}:", { class: v.Selecor_title }), a = w.elementLayout.createElement("span", "还没有选择哦~", { class: v.Selecor_title, "v-show": "!selectedDetailList || selectedDetailList.length == 0", style: "color: #999" }), e = w.elementLayout.createWrap(i + t + a, { class: v.Selecor_selected }), w.elementLayout.createWrap(e, { class: v.SelecorWrap }) } function o() { return P.template = g, P.data = x, P.props = F, P.methods = W, P.watch = { hoverSelectorStateList: { deep: !0, handler: function (e) { } }, selectedIdList: { deep: !0, handler: function (e) { var t = [], n = this, i = []; t = e.map(function (e) { return i.push(n.patDwonDataMap[e].linkMap), { id: e, text: n.patDwonDataMap[e][S.text] } }), this.selectedStateList = i, this.selectedDetailList = t, this.$emit("selectioncomplete", t) } }, showdrop: function (e) { e && this._computedDropDefaultValue() } }, Object.keys(L).forEach(function (e) { P[e] = L[e] }), P } function l() { e.component(y, o()) } function c(e) { e.lineData && (_.showLine = !0), h = e.mainData, f = _.showLine ? e.lineData : [] } function s(e) { var t = e.alias; t && (S = t) } function r() { return E(), { install: l } } function u() { var e = this; document.body.onclick = function (t) { w.controlls.close.call(e) } } function d(e) { var t = []; return e.forEach(function (e) { var n = I.patDwonDataMap[e]; n && t.push({ id: n[S.id], text: n[S.text] }) }), t } function p() { m.clearSelectedValue() } var m = null, h = [], f = [], _ = { showLine: !1 }, S = { children: "children", text: "text", id: "id" }, L = { created: function () { m = this, this._computedDefaultSelectedValue() }, mounted: function () { var e = this.$refs.lineWrap; this.dropSize.width = e.offsetWidth, this.dropSize.itemNumber = this.zIndexLevel + 1, this.dropSize.itemWidth = (e.offsetWidth / (this.zIndexLevel + 1)).toFixed(0), u.call(this) } }, v = { MainWrap: "sunSelection", LineWrap: "sunSelection__line_wrap", LineItem: "sunSelection__line_item", LineList: "sunSelection__line_list", DropPanel: "sunSelection__drop_panel", DropPanel_title: "sunSelection__drop_title", DropPanel_list_wrap: "sunSelection__list_wrap", DropPanel_list: "sunSelection__drop_list", DropPanel_listItem: "sunSelection__drop_listItem", SelecorWrap: "sunSelection__selector_wrap", Selecor_controll: "sunSelection__selector_controll", Selecor_controllItem: "sunSelection__controll_item", Selecor_selected: "sunSelection__selector_selected", Selecor_selectedItem: "sunSelection__selected_item", Selecor_icon_cancel: "sunSelection__icon_cancel", Selecor_title: "sunSelection__title", clear: "button_danger", close: "button_empty" }, D = { stateLib: { overflow: function (e) { return { type: "overflow", ruleValue: m.getVerSelectedNumber(), inputValue: e } } }, message: function (e) { return D.stateLib[e.type](e.value) } }, y = "sunSelection", g = "", w = { elementLayout: { createPackingElement: function (e, t) { return this.createElement("span", e, t) }, createWrap: function (e, t) { return this.createElement("div", e, t) }, createList: function (e, t) { return this.createElement("ul", e, t) }, createListItem: function (e, t) { return this.createElement("li", e, t) }, createElement: function (e, t, n) { return w.elementLayout.startTag(e, n) + t + w.elementLayout.endTag(e) }, startTag: function (e, t) { return "<" + e + w.common.propsToString(t) + ">" }, endTag: function (e) { return "</" + e + ">" } }, common: { propsToString: function (e) { var t = ""; return Object.keys(e).forEach(function (n) { t += k.space + n + "=" + w.common.generateString(e[n]) }), t }, generateString: function (e, t) { return '"' + e + '"' }, _createFacProps: function (e, t) { return e = e.name, "Array" == e ? w.common._ArrayFac(t) : "String" == e ? w.common._StringFac(t) : "Boolean" == e ? w.common._BooleanFac(t) : "Number" == e ? w.common._NumberFac(t) : "Object" == e ? w.common._ObjectFac(t) : void 0 }, _ArrayFac: function (e) { return { type: Array, default: w.common._FacShell(e, []) } }, _StringFac: function (e) { return { type: String, default: e || "" } }, _BooleanFac: function (e) { return { type: Boolean, default: !1 !== e && e } }, _NumberFac: function (e) { return { type: Number, default: e || 0 } }, _ObjectFac: function (e) { return { type: Object, default: w.common._FacShell(e, {}) } }, _FacShell: function (e, t) { return function () { return e || t } }, _createLevel: function (e, t) { return e + "" + t.toString(16) }, _computedStyleText: function (e, t) { var n = ""; Object.keys(t).forEach(function (e) { n += e + ":" + t[e] }), Object.keys(e).forEach(function (t) { n += t + ":" + e[t] }) } }, setData: function (e, t) { I[e] = t, x = w.common._FacShell(I) }, tools: { forEachForNum: function (e, t) { for (var n = 0; n < e && !t(n) ; n++); }, emit: function (e, t) { this.$emit(e, t) }, hasClass: function (e, t) { var n = e.classList; return Array.prototype.indexOf.call(n, t) >= 0 }, getParent: function (e) { return e.parentNode }, computedLinkMap: function (e, t, n, i) { for (var a = [], o = 0; o <= i; o++) a.push(e.slice(0, 2 + o)); if (I.patDwonDataMap.LinkListOfDataForFirst) { if (I.patDwonDataMap.LinkListOfDataForFirst.length - 1 < I.zIndexLevel) { var l = I.patDwonDataMap.LinkListOfDataForFirst.map(function (e) { return e.length }); l.indexOf(a.length) < 0 && I.patDwonDataMap.LinkListOfDataForFirst.push(a) } } else I.patDwonDataMap.LinkListOfDataForFirst = [], I.patDwonDataMap.LinkListOfDataForFirst.push(a); return a }, tirrger: function (e) { return function (t, n) { m.$emit(t, e[t](n)) } }(D) }, controlls: { clear: function () { this.selectedStateList = [], this.selectedIdList = [] }, close: function () { this.hoverSelectorStateList = [], this.$emit("closepanle") } } }, I = { lineData: f, mainData: h, hoverSelectorStateList: [], selectedStateList: [], selectedIdList: [], defaultWidth: 160, defaultItemHeight: 35, zIndexLevel: 0, dropSize: { width: 0, itemWidth: 0, itemNumber: 0 }, patDwonDataMap: {}, selectedDetailList: [], alias: S }, x = w.common._FacShell(I), F = { data: w.common._createFacProps(Object, {}), option: w.common._createFacProps(Object, { alias: S, layout: { itemHeight: 25, center: !0 }, selectNum: 3, lastOnly: !0, cancel: !0 }), showdrop: w.common._createFacProps(Boolean, !1), defaultvalue: w.common._createFacProps(Array, []), clearselectedvalue: w.common._createFacProps(Boolean, !1), title: w.common._createFacProps(String, "选择"), controlls: w.common._createFacProps(Array, [{ text: "清空", type: "clear" }, { text: "关闭", type: "close" }]) }, O = { selectNum: 1, lastOnly: !1, cancel: !0 }, k = { space: " " }, P = {}, W = { itemClick: function (e) { var t = e.target.dataset; this.switchLastOnly("true" == t.islast, function () { var e = []; this.hoverSelectorStateList.forEach(function (t, n) { e.push(t) }), this.swicthSelectedNumEvent(function (n, i) { var a = this.selectedIdList.indexOf(t.id); if (a >= 0) return void (this.option.cancel && this._cancelSelectedItem(a)); if (n) { if (1 != i) return void w.tools.tirrger("message", { type: "overflow", value: i }); this.clearSelectedValue() } this.selectedIdList.push(t.id), this.selectedIdList.length >= i && "line" == t.module && (this.hoverSelectorStateList = []), this.$set(this.selectedStateList, this.selectedStateList.length, e) }) }) }, itemOver: function (e) { var t = e.target.dataset, n = t.level, i = (t.index, t.name); 0 == n ? (this.hoverSelectorStateList = [], this.hoverSelectorStateList.push(i)) : this.$set(this.hoverSelectorStateList, n, i) }, switchLastOnly: function (e, t) { this.option.lastOnly ? e && t.call(this) : t.call(this) }, swicthSelectedNumEvent: function (e) { var t = this; setTimeout(function () { var n = t.getVerSelectedNumber(), i = t.selectedIdList.length, a = n <= i; e.apply(t, [a, n]) }, 50) }, getVerSelectedNumber: function () { return this.option.selectNum ? this.option.selectNum : O.selectNum }, clearSelectedValue: function () { this.selectedIdList = [], this.selectedStateList = [] }, cancelItem: function (e) { this.selectedIdList = this.selectedIdList.filter(function (t) { return t !== e }) }, controllSwicthCenter: function (e) { w.controlls[e] && w.controlls[e].call(this) }, _cancelSelectedItem: function (e) { this.selectedIdList.splice(e, 1), this.selectedStateList.splice(e, 1) }, _computedDefaultWidthAndPosition: function (e) { var t = this.option.layout && this.option.layout.width ? this.option.layout.width : this.defaultWidth, n = this.option.layout && this.option.layout.itemHeight ? this.option.layout.itemHeight : this.defaultItemHeight; return 0 == e ? "width:" + t + "px;left: 0;top:" + n + "px" : "width:" + t + "px;right:-" + t + "px;text-aligin:center" }, _computedItemDefaultSize: function () { var e = this.option.layout && this.option.layout.itemHeight ? this.option.layout.itemHeight : this.defaultItemHeight; return "height: " + e + "px; line-height:" + e + "px" }, __computedSelectedItemList: function (e, t) { var n = !1; return this.selectedStateList.forEach(function (e) { n || e.indexOf(t) >= 0 && (n = !0) }), n }, _computedDropDefaultSelect: function () { function e(e, t) { console.log("第" + t + "条状态线"), e.forEach(function (e) { console.log(e.split("")) }) } this.selectedStateList.forEach(function (t, n) { t.sort(function (e, t) { return e[0] < t[0] }), e(t, n) }), this._initDropData() }, _computedDropPanelItemSize: function (e) { return 0 == e ? "width:" + this.dropSize.itemWidth + "px;" : "width:" + this.dropSize.itemWidth + "px;left: " + this.dropSize.itemWidth + "px" }, _computedDefaultSelectedValue: function () { var e = this; this.selectedIdList = this.defaultvalue, this.defaultvalue.forEach(function (t) { var n = e.patDwonDataMap[t], i = []; n && (i = e.patDwonDataMap[t].linkMap, e.selectedStateList.push(i)) }) }, _getBtnClass: function (e) { return v[e] }, _computedDropDefaultValue: function () { var e = this; if (e.selectedStateList.length > 0) return void (e.hoverSelectorStateList = this.selectedStateList[0].map(function (e) { return e })); e.hoverSelectorStateList = e.patDwonDataMap.LinkListOfDataForFirst[1] } }, E = function () { var e = n(), t = i(); g = w.elementLayout.createWrap(e + t, { class: v.MainWrap }) }; t.initSelector = function (t, n) { return c(t), s(n), e.use(r()), { getValueForId: d, clearSelected: p } } }(Vue, window);