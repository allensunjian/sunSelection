"use strict";!function(e,t){function n(t,n,i){function o(){function e(t,n,o){var a="",l="";return t.forEach(function(t,c){var s=t[g.children],r=D.common._createLevel(o,c);s&&s.length>0?(a=D.elementLayout.createList(e(s,n+1,r),{class:I.LineList,"data-parent":r,"v-show":"!showdrop && hoverSelectorStateList.indexOf('"+r+"') >= 0",":style":" _computedDefaultWidthAndPosition("+n+") "}),i=i<n+1?n+1:i):a="",t.linkMap=D.tools.computedLinkMap(r,t[g.text],t[g.id],n),O.patDwonDataMap[t[g.id]]=t,l+=D.elementLayout.createListItem(t[g.text]+a,{class:I.LineItem+" "+(n>0&&Boolean(a)&&"sunSelection__state_hasChildren"),"@click.stop":"itemClick($event)","@mouseover.stop":"itemOver","data-id":t[g.id],"data-level":n,"data-index":c,"data-name":r,"data-isroot":0==n,"data-islast":""==a,"data-module":"line",":style":"_computedItemDefaultSize()",":class":"{'sunSelection__state_hover':(hoverSelectorStateList.indexOf('"+r+"') >= 0),'sunSelection__state_selected': !showdrop && __computedSelectedItemList("+c+",'"+r+"'),'sunSelection__icon_selected': !showdrop && selectedIdList.indexOf('"+t[g.id]+"') >= 0}",ref:t[g.id]})}),l}var t="",n="",i=1;return t=D.elementLayout.createList(e(L,0,0),{class:I.LineList}),n=D.elementLayout.createWrap(t,{class:I.LineWrap,ref:"lineWrap"}),D.setData("zIndexLevel",i),n}function a(){function e(t,n,i){var o="",a="",l=function(e,t){return D.elementLayout.createPackingElement(e,t)},c="";return t.forEach(function(t,s){var r=t[g.children],u=D.common._createLevel(i,s);o=r&&r.length>0?D.elementLayout.createList(e(r,n+1,u),{class:I.DropPanel_list,"data-parent":u,"v-show":"hoverSelectorStateList.indexOf('"+u+"') >= 0",":style":" _computedDropPanelItemSize("+n+"1) "}):"",t.linkMap=D.tools.computedLinkMap(u,t[g.text],t[g.id],n),O.patDwonDataMap[t[g.id]]=t,c=l(t[g.text],{class:"drop__packing "+(Boolean(o)&&"sunSelection__state_hasChildren"),"@click.stop":"itemClick($event)","@mouseover.stop":"itemOver","data-id":t[g.id],"data-level":n,"data-index":s,"data-name":u,"data-isroot":0==n,"data-islast":""==o,"data-module":"drop",":class":"{'sunSelection__icon_selected': selectedIdList.indexOf('"+t[g.id]+"') >= 0}"}),a+=D.elementLayout.createListItem(c+o,{class:I.DropPanel_listItem,":style":"_computedItemDefaultSize()",":class":"{'sunSelection__state_hover': (hoverSelectorStateList.indexOf('"+u+"') >= 0),'sunSelection__state_selected': __computedSelectedItemList("+s+",'"+u+"')}",ref:t[g.id]})}),a}var t=D.elementLayout.createList(e(S,0,0),{class:I.DropPanel_list,":style":"_computedDropPanelItemSize(0)"}),n=D.elementLayout.createWrap(t,{class:I.DropPanel_list_wrap}),i=D.elementLayout.createElement("span","{{item.text}}",{class:I.Selecor_controllItem,"v-for":"(item, index) in controlls","@click":"controllSwicthCenter(item.type)",":class":"_getBtnClass(item.type)"}),o=D.elementLayout.createWrap(i,{class:I.Selecor_controll}),a=D.elementLayout.createWrap("{{title}}"+o,{class:I.DropPanel_title}),c=l();return D.elementLayout.createWrap(a+c+n,{class:I.DropPanel,"v-show":"showdrop",ref:"dropPanel"})}function l(){var e="",t="",n="",i="",o="";return n=D.elementLayout.createElement("i","",{class:I.Selecor_icon_cancel}),t=D.elementLayout.createElement("span","{{item[alias.text]}}"+n,{class:I.Selecor_selectedItem,"v-for":"(item,index) in selectedDetailList","v-show":"selectedDetailList.length > 0","@click.stop":"cancelItem(item[alias.id])"}),i=D.elementLayout.createElement("span","{{option.selector.title || '已选择'}}:",{class:I.Selecor_title}),o=D.elementLayout.createElement("span","还没有选择哦~",{class:I.Selecor_title,"v-show":"!selectedDetailList || selectedDetailList.length == 0",style:"color: #999"}),e=D.elementLayout.createWrap(i+t+o,{class:I.Selecor_selected}),D.elementLayout.createWrap(e,{class:I.SelecorWrap})}function c(){return M.template=F,M.data=k,M.props=P,M.methods=b,M.watch={hoverSelectorStateList:{deep:!0,handler:function(e){}},selectedIdList:{deep:!0,handler:function(e){var t=[],n=this,i=[];t=e.map(function(e){return i.push(n.patDwonDataMap[e].linkMap),{id:e,text:n.patDwonDataMap[e][g.text]}}),this.selectedStateList=i,this.selectedDetailList=t,this.$emit("selectioncomplete",t)}},showdrop:function(e){e&&this._computedDropDefaultValue()}},Object.keys(w).forEach(function(e){M[e]=w[e]}),console.log(M),M}function s(){e.component(x,c())}function r(e){e.lineData&&(y.showLine=!0),S=e.mainData,L=y.showLine?e.lineData:[]}function u(e){var t=e.alias;t&&(g=t)}function d(){return z(),{install:s}}function p(){var e=this;document.onclick=function(t){D.controlls.close.call(e)}}function m(e){var t=[];return e.forEach(function(e){var n=O.patDwonDataMap[e];n&&t.push({id:n[g.id],text:n[g.text]})}),t}function h(){_.clearSelectedValue()}function f(e){e&&(x=e)}var _=null,S=[],L=[],v={stateLib:{overflow:function(e){return{type:"overflow",ruleValue:_.getVerSelectedNumber(),inputValue:e}}},message:function(e){return v.stateLib[e.type](e.value)}},D={elementLayout:{createPackingElement:function(e,t){return this.createElement("span",e,t)},createWrap:function(e,t){return this.createElement("div",e,t)},createList:function(e,t){return this.createElement("ul",e,t)},createListItem:function(e,t){return this.createElement("li",e,t)},createElement:function(e,t,n){return D.elementLayout.startTag(e,n)+t+D.elementLayout.endTag(e)},startTag:function(e,t){return"<"+e+D.common.propsToString(t)+">"},endTag:function(e){return"</"+e+">"}},common:{propsToString:function(e){var t="";return Object.keys(e).forEach(function(n){t+=E.space+n+"="+D.common.generateString(e[n])}),t},generateString:function(e,t){return'"'+e+'"'},_createFacProps:function(e,t){return e=e.name,"Array"==e?D.common._ArrayFac(t):"String"==e?D.common._StringFac(t):"Boolean"==e?D.common._BooleanFac(t):"Number"==e?D.common._NumberFac(t):"Object"==e?D.common._ObjectFac(t):void 0},_ArrayFac:function(e){return{type:Array,default:D.common._FacShell(e,[])}},_StringFac:function(e){return{type:String,default:e||""}},_BooleanFac:function(e){return{type:Boolean,default:!1!==e&&e}},_NumberFac:function(e){return{type:Number,default:e||0}},_ObjectFac:function(e){return{type:Object,default:D.common._FacShell(e,{})}},_FacShell:function(e,t){return function(){return e||t}},_createLevel:function(e,t){return e+""+t.toString(16)},_computedStyleText:function(e,t){var n="";Object.keys(t).forEach(function(e){n+=e+":"+t[e]}),Object.keys(e).forEach(function(t){n+=t+":"+e[t]})}},setData:function(e,t){O[e]=t,k=D.common._FacShell(O)},tools:{forEachForNum:function(e,t){for(var n=0;n<e&&!t(n);n++);},emit:function(e,t){this.$emit(e,t)},hasClass:function(e,t){var n=e.classList;return Array.prototype.indexOf.call(n,t)>=0},getParent:function(e){return e.parentNode},computedLinkMap:function(e,t,n,i){for(var o=[],a=0;a<=i;a++)o.push(e.slice(0,2+a));if(O.patDwonDataMap.LinkListOfDataForFirst){if(O.patDwonDataMap.LinkListOfDataForFirst.length-1<O.zIndexLevel){var l=O.patDwonDataMap.LinkListOfDataForFirst.map(function(e){return e.length});l.indexOf(o.length)<0&&O.patDwonDataMap.LinkListOfDataForFirst.push(o)}}else O.patDwonDataMap.LinkListOfDataForFirst=[],O.patDwonDataMap.LinkListOfDataForFirst.push(o);return o},tirrger:function(e){return function(t,n){_.$emit(t,e[t](n))}}(v)},controlls:{clear:function(){this.selectedStateList=[],this.selectedIdList=[]},close:function(){console.log("close"),this.hoverSelectorStateList=[],this.$emit("closepanle")}}},y={showLine:!1},g={children:"children",text:"text",id:"id"},w=D.common._FacShell({created:function(){_=this,this._computedDefaultSelectedValue()},mounted:function(){var e=this.$refs.lineWrap;this.dropSize.width=e.offsetWidth,this.dropSize.itemNumber=this.zIndexLevel+1,this.dropSize.itemWidth=(e.offsetWidth/(this.zIndexLevel+1)).toFixed(0),p.call(this)}})(),I={MainWrap:"sunSelection",LineWrap:"sunSelection__line_wrap",LineItem:"sunSelection__line_item",LineList:"sunSelection__line_list",DropPanel:"sunSelection__drop_panel",DropPanel_title:"sunSelection__drop_title",DropPanel_list_wrap:"sunSelection__list_wrap",DropPanel_list:"sunSelection__drop_list",DropPanel_listItem:"sunSelection__drop_listItem",SelecorWrap:"sunSelection__selector_wrap",Selecor_controll:"sunSelection__selector_controll",Selecor_controllItem:"sunSelection__controll_item",Selecor_selected:"sunSelection__selector_selected",Selecor_selectedItem:"sunSelection__selected_item",Selecor_icon_cancel:"sunSelection__icon_cancel",Selecor_title:"sunSelection__title",clear:"button_danger",close:"button_empty"},x="sunSelection",F="",O=D.common._FacShell({lineData:L,mainData:S,hoverSelectorStateList:[],selectedStateList:[],selectedIdList:[],defaultWidth:160,defaultItemHeight:35,zIndexLevel:0,dropSize:{width:0,itemWidth:0,itemNumber:0},patDwonDataMap:{},selectedDetailList:[],alias:g})(),k=D.common._FacShell(O),P=D.common._FacShell({data:D.common._createFacProps(Object,{}),option:D.common._createFacProps(Object,{alias:g,layout:{itemHeight:25,center:!0},selectNum:3,lastOnly:!0,cancel:!0}),showdrop:D.common._createFacProps(Boolean,!1),defaultvalue:D.common._createFacProps(Array,[]),clearselectedvalue:D.common._createFacProps(Boolean,!1),title:D.common._createFacProps(String,"选择"),controlls:D.common._createFacProps(Array,[{text:"清空",type:"clear"},{text:"关闭",type:"close"}])})(),W={selectNum:1,lastOnly:!1,cancel:!0},E={space:" "},M={},b={itemClick:function(e){var t=e.target.dataset;this.switchLastOnly("true"==t.islast,function(){var e=[];this.hoverSelectorStateList.forEach(function(t,n){e.push(t)}),console.log(this.hoverSelectorStateList),this.swicthSelectedNumEvent(function(n,i){var o=this.selectedIdList.indexOf(t.id);if(o>=0)return void(this.option.cancel&&this._cancelSelectedItem(o));if(n){if(1!=i)return void D.tools.tirrger("message",{type:"overflow",value:i});this.clearSelectedValue()}this.selectedIdList.push(t.id),this.selectedIdList.length>=i&&"line"==t.module&&(this.hoverSelectorStateList=[]),this.$set(this.selectedStateList,this.selectedStateList.length,e)})})},itemOver:function(e){var t=e.target.dataset,n=t.level,i=(t.index,t.name);0==n?(this.hoverSelectorStateList=[],this.hoverSelectorStateList.push(i)):this.$set(this.hoverSelectorStateList,n,i),console.log(this.hoverSelectorStateList)},switchLastOnly:function(e,t){this.option.lastOnly?e&&t.call(this):t.call(this)},swicthSelectedNumEvent:function(e){var t=this;setTimeout(function(){var n=t.getVerSelectedNumber(),i=t.selectedIdList.length,o=n<=i;e.apply(t,[o,n])},50)},getVerSelectedNumber:function(){return this.option.selectNum?this.option.selectNum:W.selectNum},clearSelectedValue:function(){this.selectedIdList=[],this.selectedStateList=[]},cancelItem:function(e){this.selectedIdList=this.selectedIdList.filter(function(t){return t!==e})},controllSwicthCenter:function(e){D.controlls[e]&&D.controlls[e].call(this)},_cancelSelectedItem:function(e){this.selectedIdList.splice(e,1),this.selectedStateList.splice(e,1)},_computedDefaultWidthAndPosition:function(e){var t=this.option.layout&&this.option.layout.width?this.option.layout.width:this.defaultWidth,n=this.option.layout&&this.option.layout.itemHeight?this.option.layout.itemHeight:this.defaultItemHeight;return 0==e?"width:"+t+"px;left: 0;top:"+n+"px":"width:"+t+"px;right:-"+t+"px;text-aligin:center"},_computedItemDefaultSize:function(){var e=this.option.layout&&this.option.layout.itemHeight?this.option.layout.itemHeight:this.defaultItemHeight;return"height: "+e+"px; line-height:"+e+"px"},__computedSelectedItemList:function(e,t){var n=!1;return this.selectedStateList.forEach(function(e){n||e.indexOf(t)>=0&&(n=!0)}),n},_computedDropDefaultSelect:function(){function e(e,t){console.log("第"+t+"条状态线"),e.forEach(function(e){console.log(e.split(""))})}this.selectedStateList.forEach(function(t,n){t.sort(function(e,t){return e[0]<t[0]}),e(t,n)}),this._initDropData()},_computedDropPanelItemSize:function(e){return 0==e?"width:"+this.dropSize.itemWidth+"px;":"width:"+this.dropSize.itemWidth+"px;left: "+this.dropSize.itemWidth+"px"},_computedDefaultSelectedValue:function(){var e=this;this.selectedIdList=this.defaultvalue,this.defaultvalue.forEach(function(t){var n=e.patDwonDataMap[t],i=[];n&&(i=e.patDwonDataMap[t].linkMap,e.selectedStateList.push(i))})},_getBtnClass:function(e){return I[e]},_computedDropDefaultValue:function(){var e=this;if(e.selectedStateList.length>0)return void(e.hoverSelectorStateList=this.selectedStateList[0].map(function(e){return e}));e.hoverSelectorStateList=e.patDwonDataMap.LinkListOfDataForFirst[1]}},z=function(){var e=o(),t=a();F=D.elementLayout.createWrap(e+t,{class:I.MainWrap})};return function(t,n,i){return r(t),u(n),f(i),e.use(d()),{getValueForId:m,clearSelected:h}}(t,n,i)}t.CreateSelector=n}(Vue,window);